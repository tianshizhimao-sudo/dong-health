<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="theme-color" content="#1a1a2e">
  <title>ğŸƒ è¿åŠ¨è¡¥ç»™</title>
  <style>
    :root {
      --bg: #1a1a2e;
      --card: #16213e;
      --accent: #10b981;
      --accent-light: #34d399;
      --text: #eaeaea;
      --muted: #a0a0a0;
      --success: #10b981;
      --warning: #f59e0b;
      --danger: #ef4444;
      --border: #0f3460;
      --input-bg: #0f1729;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      padding: 16px;
      padding-bottom: 100px;
    }
    .container { max-width: 500px; margin: 0 auto; }
    
    header { text-align: center; padding: 16px 0 20px; }
    h1 { font-size: 24px; margin-bottom: 4px; }
    .subtitle { color: var(--muted); font-size: 13px; }
    
    .back-link {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      color: var(--accent);
      text-decoration: none;
      font-size: 14px;
      margin-bottom: 16px;
    }
    
    .section {
      background: var(--card);
      border-radius: 14px;
      padding: 16px;
      margin-bottom: 12px;
      border: 1px solid var(--border);
    }
    .section-title {
      font-size: 15px;
      font-weight: 700;
      margin-bottom: 12px;
      color: var(--accent-light);
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .section-badge {
      font-size: 11px;
      padding: 4px 10px;
      background: rgba(255,255,255,0.1);
      border-radius: 20px;
      color: var(--muted);
      font-weight: 500;
    }
    
    .item-list { display: flex; flex-direction: column; gap: 8px; }
    
    .item {
      background: rgba(255,255,255,0.03);
      border-radius: 10px;
      padding: 12px;
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .item-icon {
      width: 40px;
      height: 40px;
      background: rgba(16, 185, 129, 0.2);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      flex-shrink: 0;
    }
    .item-info { flex: 1; }
    .item-name { font-size: 15px; font-weight: 600; }
    .item-detail { font-size: 12px; color: var(--muted); margin-top: 2px; }
    .item-qty {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .qty-btn {
      width: 32px;
      height: 32px;
      border: none;
      border-radius: 8px;
      background: var(--border);
      color: var(--text);
      font-size: 18px;
      cursor: pointer;
    }
    .qty-btn:active { background: var(--accent); }
    .qty-num {
      font-size: 18px;
      font-weight: 700;
      min-width: 30px;
      text-align: center;
    }
    .qty-num.low { color: var(--warning); }
    .qty-num.out { color: var(--danger); }
    
    .add-form {
      display: flex;
      gap: 8px;
      margin-top: 16px;
    }
    .add-form input, .add-form select {
      flex: 1;
      padding: 12px;
      background: var(--input-bg);
      border: 1px solid var(--border);
      border-radius: 10px;
      color: var(--text);
      font-size: 14px;
    }
    .add-form button {
      padding: 12px 20px;
      background: var(--accent);
      border: none;
      border-radius: 10px;
      color: white;
      font-weight: 600;
      cursor: pointer;
    }
    
    .empty {
      text-align: center;
      padding: 40px 20px;
      color: var(--muted);
    }
    
    .sync-status {
      text-align: center;
      font-size: 11px;
      color: var(--muted);
      margin-top: 20px;
    }
    .sync-status.synced { color: var(--success); }
    
    .quick-add {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 12px;
    }
    .quick-chip {
      padding: 8px 14px;
      background: rgba(16, 185, 129, 0.15);
      border: 1px solid rgba(16, 185, 129, 0.3);
      border-radius: 20px;
      font-size: 13px;
      cursor: pointer;
      color: var(--accent-light);
    }
    .quick-chip:active { background: var(--accent); color: white; }
  </style>
</head>
<body>
  <div class="container">
    <a href="index.html" class="back-link">â† è¿”å›å¥èº«ä¸­å¿ƒ</a>
    
    <header>
      <h1>ğŸƒ è¿åŠ¨è¡¥ç»™</h1>
      <p class="subtitle">è·‘æ­¥ Â· å¥èº« Â· èƒ½é‡è¡¥å……</p>
    </header>
    
    <div class="section">
      <div class="section-title">
        <span>âš¡ èƒ½é‡è¡¥ç»™</span>
        <span class="section-badge" id="energy-count">0 ä»¶</span>
      </div>
      <div class="item-list" id="energy-list"></div>
    </div>
    
    <div class="section">
      <div class="section-title">
        <span>ğŸ’Š ç”µè§£è´¨ / ç›ä¸¸</span>
        <span class="section-badge" id="electro-count">0 ä»¶</span>
      </div>
      <div class="item-list" id="electro-list"></div>
    </div>
    
    <div class="section">
      <div class="section-title">
        <span>ğŸ¥¤ è¿åŠ¨é¥®æ–™ / è›‹ç™½</span>
        <span class="section-badge" id="drink-count">0 ä»¶</span>
      </div>
      <div class="item-list" id="drink-list"></div>
    </div>
    
    <div class="section">
      <div class="section-title">æ·»åŠ è¡¥ç»™</div>
      <div class="quick-add" id="quick-add">
        <span class="quick-chip" data-name="GUèƒ½é‡èƒ¶" data-cat="energy" data-icon="âš¡">+ GUèƒ½é‡èƒ¶</span>
        <span class="quick-chip" data-name="SISèƒ½é‡èƒ¶" data-cat="energy" data-icon="âš¡">+ SISèƒ½é‡èƒ¶</span>
        <span class="quick-chip" data-name="Maurtenèƒ½é‡èƒ¶" data-cat="energy" data-icon="âš¡">+ Maurten</span>
        <span class="quick-chip" data-name="ç›ä¸¸" data-cat="electro" data-icon="ğŸ’Š">+ ç›ä¸¸</span>
        <span class="quick-chip" data-name="ç”µè§£è´¨ç²‰" data-cat="electro" data-icon="ğŸ’Š">+ ç”µè§£è´¨ç²‰</span>
        <span class="quick-chip" data-name="Nuunæ³¡è…¾ç‰‡" data-cat="electro" data-icon="ğŸ’Š">+ Nuun</span>
        <span class="quick-chip" data-name="è›‹ç™½ç²‰" data-cat="drink" data-icon="ğŸ¥¤">+ è›‹ç™½ç²‰</span>
        <span class="quick-chip" data-name="BCAA" data-cat="drink" data-icon="ğŸ¥¤">+ BCAA</span>
        <span class="quick-chip" data-name="ä½³å¾—ä¹" data-cat="drink" data-icon="ğŸ¥¤">+ ä½³å¾—ä¹</span>
      </div>
      <form class="add-form" id="add-form">
        <input type="text" id="item-name" placeholder="è¡¥ç»™åç§°" required>
        <select id="item-cat">
          <option value="energy">èƒ½é‡</option>
          <option value="electro">ç”µè§£è´¨</option>
          <option value="drink">é¥®æ–™</option>
        </select>
        <button type="submit">æ·»åŠ </button>
      </form>
    </div>
    
    <div class="sync-status" id="sync-status">æ•°æ®æœ¬åœ°å­˜å‚¨</div>
  </div>

  <script>
    // Storage key - shared with home inventory
    const STORAGE_KEY = 'fitness-supplements-v1';
    
    // Default items with emoji
    const ICONS = {
      energy: 'âš¡',
      electro: 'ğŸ’Š',
      drink: 'ğŸ¥¤'
    };
    
    // State
    let items = [];
    
    // Load from localStorage
    function load() {
      try {
        const saved = localStorage.getItem(STORAGE_KEY);
        if (saved) {
          items = JSON.parse(saved);
        }
      } catch (e) {
        console.error('Load error:', e);
      }
      render();
    }
    
    // Save to localStorage
    function save() {
      try {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(items));
        showSyncStatus('å·²ä¿å­˜ âœ“', true);
      } catch (e) {
        console.error('Save error:', e);
        showSyncStatus('ä¿å­˜å¤±è´¥', false);
      }
    }
    
    function showSyncStatus(msg, success) {
      const el = document.getElementById('sync-status');
      el.textContent = msg;
      el.className = 'sync-status' + (success ? ' synced' : '');
      setTimeout(() => {
        el.textContent = 'æ•°æ®æœ¬åœ°å­˜å‚¨';
        el.className = 'sync-status';
      }, 2000);
    }
    
    // Render items
    function render() {
      const lists = {
        energy: document.getElementById('energy-list'),
        electro: document.getElementById('electro-list'),
        drink: document.getElementById('drink-list')
      };
      const counts = {
        energy: 0,
        electro: 0,
        drink: 0
      };
      
      // Clear lists
      Object.values(lists).forEach(l => l.innerHTML = '');
      
      // Group items
      items.forEach((item, idx) => {
        const cat = item.category || 'energy';
        counts[cat]++;
        
        const qtyClass = item.qty === 0 ? 'out' : item.qty <= 2 ? 'low' : '';
        
        lists[cat].innerHTML += `
          <div class="item">
            <div class="item-icon">${item.icon || ICONS[cat]}</div>
            <div class="item-info">
              <div class="item-name">${item.name}</div>
              <div class="item-detail">${item.note || ''}</div>
            </div>
            <div class="item-qty">
              <button class="qty-btn" onclick="updateQty(${idx}, -1)">âˆ’</button>
              <span class="qty-num ${qtyClass}">${item.qty}</span>
              <button class="qty-btn" onclick="updateQty(${idx}, 1)">+</button>
            </div>
          </div>
        `;
      });
      
      // Update counts
      document.getElementById('energy-count').textContent = counts.energy + ' ä»¶';
      document.getElementById('electro-count').textContent = counts.electro + ' ä»¶';
      document.getElementById('drink-count').textContent = counts.drink + ' ä»¶';
      
      // Show empty state if needed
      Object.entries(lists).forEach(([cat, list]) => {
        if (counts[cat] === 0) {
          list.innerHTML = '<div class="empty">æš‚æ— è¡¥ç»™</div>';
        }
      });
    }
    
    // Update quantity
    function updateQty(idx, delta) {
      items[idx].qty = Math.max(0, items[idx].qty + delta);
      save();
      render();
    }
    
    // Add item
    function addItem(name, category, icon) {
      // Check if exists
      const existing = items.find(i => i.name === name && i.category === category);
      if (existing) {
        existing.qty++;
      } else {
        items.push({
          name,
          category,
          icon: icon || ICONS[category],
          qty: 1,
          note: ''
        });
      }
      save();
      render();
    }
    
    // Form submit
    document.getElementById('add-form').addEventListener('submit', (e) => {
      e.preventDefault();
      const name = document.getElementById('item-name').value.trim();
      const cat = document.getElementById('item-cat').value;
      if (name) {
        addItem(name, cat);
        document.getElementById('item-name').value = '';
      }
    });
    
    // Quick add chips
    document.getElementById('quick-add').addEventListener('click', (e) => {
      if (e.target.classList.contains('quick-chip')) {
        const name = e.target.dataset.name;
        const cat = e.target.dataset.cat;
        const icon = e.target.dataset.icon;
        addItem(name, cat, icon);
      }
    });
    
    // Init
    load();
  </script>
</body>
</html>
